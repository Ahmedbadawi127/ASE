@page "/viewcustomers"
@inject Microsoft.AspNetCore.Components.NavigationManager Navigation

<h3>عرض العملاء</h3>

<div>

    <SfGrid AllowReordering="true" AllowFiltering="true" AllowExcelExport="true" AllowGrouping="true" AllowPdfExport="true"
            AllowRowDragAndDrop="true" AllowSorting="true" AllowTextWrap="true" Width="100%" AllowPaging="true" TValue="CustomersDto" EnableRtl="true">

        <GridPageSettings PageSize="20"></GridPageSettings>
        <GridEvents TValue="CustomersDto" RowSelected="OnRowSelected"></GridEvents>

        <SfDataManager Url="@($"api/ServerQueries/GetCustomers/")" Adaptor="Adaptors.WebApiAdaptor"></SfDataManager>
        <GridColumns>
            <GridColumn Field=@(nameof(CustomersDto.Id)) HeaderText="الأي دي"></GridColumn>
            <GridColumn Field=@(nameof(CustomersDto.NameAr)) HeaderText="الاسم العربي"></GridColumn>
            <GridColumn Field=@(nameof(CustomersDto.NameEn)) HeaderText="الاسم الانجليزي"></GridColumn>
            <GridColumn Field=@(nameof(CustomersDto.Phone)) HeaderText="موبايل"></GridColumn>
            <GridColumn Field=@(nameof(CustomersDto.StateName)) HeaderText="محافظة"></GridColumn>
            <GridColumn Field=@(nameof(CustomersDto.CityName)) HeaderText="مدينة"></GridColumn>
            <GridColumn Field=@(nameof(CustomersDto.GenderName)) HeaderText="الجنس"></GridColumn>
            <GridColumn Field=@(nameof(CustomersDto.Age)) HeaderText="العمر"></GridColumn>
            <GridColumn Field=@(nameof(CustomersDto.Active)) HeaderText="فعال" Type="ColumnType.Boolean">
                <Template>
                    <span>@((context as CustomersDto).Active == true ? "نعم" : "لا")</span>
                </Template>
            </GridColumn>

            <GridColumn HeaderText="تعديل" TextAlign="TextAlign.Center" Width="120">
                <Template>
                    <button class="btn-icon-btn btn-outline-light" @onclick="@(() => Edit((context as CustomersDto).Id))">
                        <img class="btn-icon" src="/img/editingColored.svg" />
                    </button>
                </Template>
            </GridColumn>
        </GridColumns>
    </SfGrid>
</div>

@code {

    CustomersDto SelectedCustomer = new CustomersDto { };


    private void OnRowSelected(RowSelectEventArgs<CustomersDto> args)
    {
        args.PreventRender = true; //without this, you may see noticable delay in selection with 75 rows in grid.
        SelectedCustomer = args.Data;
    }

    private void Edit(int Id)
    {
        Navigation.NavigateTo($"/createcustomers/{Id}");

    }

}
